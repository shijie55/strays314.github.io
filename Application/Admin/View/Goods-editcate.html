<extend name="./Public/admin/index.html"/>
<block name="css">

  <link rel="stylesheet" href="__PUBLIC__/admin/plugins/select2/select2.min.css">
</block>
<block name="main">
<div class="row">
   <div class="col-xs-12">
      <form name="import_form" method="post" action="{:U('/Goods/upcate')}">
      <div class="nav-tabs-custom">
         <ul class="nav nav-tabs">
            <li class="active"><a href="#default" data-toggle="tab">编辑商品分类</a></li>
            <!--
            <li><a href="#macinfos" class="sbxx" data-toggle="tab">设备信息</a></li>
            <li><a href="#remark" class="remark" data-toggle="tab">备注照片</a></li>
            -->
         </ul>         
         <div class="tab-content form-horizontal">            
            
            <div class="active tab-pane" id="default">
               
               <div class="form-group">
                  <label for="catename" class="col-sm-2 control-label">分类名称：</label>
                  <div class="col-sm-4 col-xs-12">
                     <input type="text" class="form-control" name="catename" id="catename" value="{$rs['catename']}">
                     <input type="hidden" name="doid" id="doid" value="{$rs['id']}" />
                  </div>
               </div>
               <div class="form-group">
                  <label for="pid" class="col-sm-2 control-label">父类：</label>
                  <div class="col-sm-2 col-xs-12">
                     <select class="form-control" name="pid" id="pid">
                        <option value="0">顶级菜单</option>
                        <volist name='catelis' id='rscate'> 
                        <option value="{$rscate['id']}" <if condition="$rs['pid'] eq $rscate['id']">selected='selected'</if>>
                        <for start="0" end="$rscate['level']">∟</for>
                        {$rscate['catename']}
                        </option>
                        </volist>
                     </select>
                  </div>
               </div>
               <div class="form-group">
                  <label for="icon" class="col-sm-2 col-xs-12 control-label">图标：</label>
                  <div class="col-sm-3 col-xs-8">
                     <p><input type="text" class="form-control" name="icon" id="icon" value="{$rs['icon']}" /></p>
                     <p><button type="button" class="btn btn-danger upload_button" id="file_upload_01" data-input="icon" data-img="icon_pic">上传</button><i class="pull-right" id="loading" style="display:none;"><img src="__PUBLIC__/admin/dist/img/loading.gif" /></i></p>
                     <p><small class="text-muted">建议尺寸：100/100(px)</small></p>                           
                  </div>
                  <div class="col-sm-1 col-xs-4">
                     <img src="<if condition="!empty($rs['icon'])">{$rs['icon']}<else />__PUBLIC__/admin/dist/img/nopic.jpg</if>" id="icon_pic" class="img-responsive" />
                  </div>
               </div>
               <div class="form-group">
                  <label for="content" class="col-sm-2 control-label">描述：</label>
                  <div class="col-sm-4 col-xs-12">
                     <textarea class="form-control" name="content" id="content">{$rs['content']}</textarea>
                  </div>
               </div>
               <div class="form-group">
                  <label for="taxis" class="col-sm-2 control-label">排序：</label>
                  <div class="col-sm-1 col-xs-12">
                     <input type="text" class="form-control text-center" name="taxis" id="taxis" value="{$rs['taxis']}">
                  </div>
               </div>
                             
            </div>             
                        
         </div>         
      </div>
      <div class="clearfix"><button type="button" class="btn btn-danger btn-sub-fm"> <i class="icon-ok bigger-110"></i>确认编辑</button></div>
      </form> 
        
   </div>
   <!-- /.col -->
</div>
</block>
<block name="js">
<script src="__PUBLIC__/admin/plugins/select2/select2.full.min.js"></script>
<script language="javascript">

$(function(){   
   
   $('.btn-sub-fm').click(function(){
      var doid = $.trim($('#doid').val());
	  var catename = $.trim($('#catename').val());
	  var pid = $.trim($('#pid').val());
	  var icon = $.trim($('#icon').val());
	  var content = $.trim($('#content').val());
	  var taxis = $.trim($('#taxis').val());
	  //alert(remark);
	  //return;
	  if(catename == ''){
	     $.fn.tips({type:'error',content:'分类名称不可为空'});
		 $('#catename').parent().parent().addClass('has-error');
		 return false;
	  }else if(taxis == ''){
	     $.fn.tips({type:'error',content:'排序指不可为空'});
		 $('#taxis').parent().parent().addClass('has-error');
		 return false;
	  }
	  
	  $.ajax({
	     url : "{:U('/Goods/upcate')}",
		 type : "POST",
		 data : {'doid':doid,'catename':catename,'pid':pid,'icon':icon,'content':content,'taxis':taxis},
		 beforeSend: function(){
		    $('.btn-sub-fm').html("<img src='__PUBLIC__/admin/dist/img/loading.gif' width='20' />");
		 },
		 success : function(d){
		    $.fn.tips({'type':d.type,'content':d.msg,'url':d.url});
		 }
	  });
	  //alert(picarr);
	  
   });
});
</script>
</block>